<?xml version="1.0" encoding="utf-8"?>
<Defs>
  <ThinkTreeDef>
    <defName>DMS_DroneConstant</defName>
    <thinkRoot Class="ThinkNode_Priority">
      <subNodes>
        <!-- Despawned -->
        <li Class="ThinkNode_Subtree">
          <treeDef>Despawned</treeDef>
        </li>
        <li Class="ThinkNode_ConditionalCanDoConstantThinkTreeJobNow">
          <subNodes>
            <li Class="ThinkNode_ConditionalOfPlayerFaction">
              <subNodes>
                <li Class="ThinkNode_Tagger">
                  <tagToGive>DraftedOrder</tagToGive>
                  <subNodes>
                    <li Class="JobGiver_MoveToStandable" />
                    <li Class="JobGiver_Orders" />
                  </subNodes>
                </li>
                <li Class="ThinkNode_QueuedJob" />
              </subNodes>
            </li>
            <!-- Keep distance -->
            <li Class="JobGiver_FleeForDistance">
              <enemyDistToFleeRange>2.9~7.9</enemyDistToFleeRange>
              <fleeDistRange>13.5~20</fleeDistRange>
            </li>
            <li Class="JobGiver_AIFightEnemies">
              <targetAcquireRadius>30</targetAcquireRadius>
              <targetKeepRadius>72</targetKeepRadius>
            </li>
            <li Class="JobGiver_AIGotoNearestHostile" />
            <li Class="Fortified.JobGiver_WanderNearPlatform" />
          </subNodes>
        </li>
      </subNodes>
    </thinkRoot>
  </ThinkTreeDef>

  <!-- 簡單來說是需要部屬的機械體，不需要機械師但沒法自己充電，能夠透過平台放置與回收。 -->
  <!-- Base -->
  <ThingDef Name="DMS_BaseDroidRace" ParentName="BaseMechanoid" Abstract="True">
    <thingClass>Fortified.WeaponUsableMech</thingClass>
    <statBases>
      <MoveSpeed>4.7</MoveSpeed>
      <ArmorRating_Blunt>0.10</ArmorRating_Blunt>
      <ArmorRating_Sharp>0.20</ArmorRating_Sharp>
      <StaggerDurationFactor>0.5</StaggerDurationFactor>
      <!-- <MarketValue>800</MarketValue> -->
      <ToxicEnvironmentResistance MayRequire="Ludeon.RimWorld.Biotech">1</ToxicEnvironmentResistance>
      <MechEnergyLossPerHP MayRequire="Ludeon.Rimworld.Biotech">0.2</MechEnergyLossPerHP>
      <WorkSpeedGlobal MayRequire="Ludeon.Rimworld.Biotech">0.8</WorkSpeedGlobal>
      <PsychicSensitivity>0</PsychicSensitivity>
    </statBases>
    <race>
      <specialShadowData>
        <volume>(0.3, 0.8, 0.4)</volume>
        <offset>(0,0,-0.3)</offset>
      </specialShadowData>
      <intelligence>ToolUser</intelligence>
      <thinkTreeMain>DMS_Mechanoid</thinkTreeMain>
      <!-- 要改 -->
      <nameGenerator>DMS_VanguardMechStandard</nameGenerator>

      <soundCallIntervalRange>2000~4000</soundCallIntervalRange>
      <soundCallIntervalFriendlyFactor>2</soundCallIntervalFriendlyFactor>
      <soundCallIntervalAggressiveFactor>0.5</soundCallIntervalAggressiveFactor>
      <thinkTreeConstant MayRequire="Ludeon.RimWorld.Biotech">DMS_DroneConstant</thinkTreeConstant>
      <soundMeleeHitPawn>Pawn_Melee_MechanoidBash_HitPawn</soundMeleeHitPawn>
      <soundMeleeHitBuilding>Pawn_Melee_MechanoidBash_HitBuilding</soundMeleeHitBuilding>
      <soundMeleeMiss>Pawn_Melee_MechanoidBash_Miss</soundMeleeMiss>
      <mechFixedSkillLevel>8</mechFixedSkillLevel>
      <lifeStageAges>
        <li>
          <def>DMS_Automatroid_BrandNew</def>
          <minAge>0</minAge>
          <soundWounded>Pawn_Mech_Cleansweeper_Wounded</soundWounded>
          <soundDeath>Pawn_Mech_Cleansweeper_Death</soundDeath>
          <soundCall>DMS_Pawn_Mech_Call</soundCall>
        </li>
        <li>
          <def>DMS_Automatroid_Damaged</def>
          <minAge>70</minAge>
          <soundWounded>Pawn_Mech_Cleansweeper_Wounded</soundWounded>
          <soundDeath>Pawn_Mech_Cleansweeper_Death</soundDeath>
          <soundCall>DMS_Pawn_Mech_Call</soundCall>
        </li>
      </lifeStageAges>
    </race>
    <comps Inherit="False">
      <li Class="CompProperties_MechRepairable" />
      <li Class="CompProperties_CanBeDormant" />
      <li Class="CompProperties_WakeUpDormant">
        <wakeUpOnDamage>true</wakeUpOnDamage>
        <wakeUpCheckRadius>30</wakeUpCheckRadius>
        <wakeUpSound>MechanoidsWakeUp</wakeUpSound>
      </li>
      <li Class="Fortified.CompProperties_Drone">
        <returnToDraftPlatformJob>FFF_ReturnToDronePlatform</returnToDraftPlatformJob>
      </li>
    </comps>
    <butcherProducts>
      <Steel>50</Steel>
    </butcherProducts>
    <tools>
      <li>
        <label>head</label>
        <capacities>
          <li>Blunt</li>
        </capacities>
        <power>6</power>
        <cooldownTime>2.6</cooldownTime>
        <linkedBodyPartsGroup>HeadAttackTool</linkedBodyPartsGroup>
        <ensureLinkedBodyPartsGroupAlwaysUsable>true</ensureLinkedBodyPartsGroupAlwaysUsable>
      </li>
    </tools>
  </ThingDef>

  <PawnKindDef Name="DMS_DroidKind" Abstract="True">
    <defaultFactionDef>Mechanoid</defaultFactionDef>
    <aiAvoidCover>true</aiAvoidCover>
    <destroyGearOnDrop>true</destroyGearOnDrop>
    <canStrip>false</canStrip>
    <minGenerationAge MayRequire="Ludeon.RimWorld.Biotech">200</minGenerationAge>
    <forceNormalGearQuality>true</forceNormalGearQuality>
  </PawnKindDef>


  <!-- 被通稱為真獸類(Eutheria)的早期機兵設計，這類非人形構造的機兵在電子控制系統尚不完善的冷戰時期中被廣泛的投入各類代理人戰爭中使用。 -->
  <ThingDef ParentName="DMS_BaseDroidRace">
    <defName>DMS_Drone_Hound</defName>
    <label>hound</label>
    <description>A deployable combat robot with capacity to using small firearms. commonly known as Eutherians, these non-humanoid robots were widely used in various proxy wars during the Cold War when electronic control systems were not yet perfect.</description>
    <statBases>
      <MoveSpeed>4.2</MoveSpeed>
    </statBases>
    <race>
      <body>DMS_Hound</body>
      <baseBodySize>0.75</baseBodySize>
      <baseHealthScale>0.75</baseHealthScale>
      <thinkTreeConstant>DMS_DroneConstant</thinkTreeConstant>
    </race>
    <comps>
      <li Class="CompProperties_MechPowerCell">
        <totalPowerTicks>15000</totalPowerTicks>
      </li>
    </comps>
    <modExtensions>
      <li Class="Fortified.MechWeaponExtension">
        <EnableWeaponFilter>true</EnableWeaponFilter>
        <UsableWeaponTags>
          <li>VerlingBird_Weapon</li>
          <li>DMS_MechWeaponUltraLight</li>
          <li>DMS_MechWeaponLight</li>
          <li>DMS_Flameblaster</li>
        </UsableWeaponTags>
        <EnableTechLevelFilter>true</EnableTechLevelFilter>
        <UsableTechLevels>
          <li>Industrial</li>
        </UsableTechLevels>
        <BypassUsableWeapons>
          <li MayRequire="ceteam.combatextended">Gun_BinocularsRadio</li>
          <li>Gun_Autopistol</li>
          <li>Gun_MachinePistol</li>
        </BypassUsableWeapons>
      </li>
    </modExtensions>
  </ThingDef>

  <PawnKindDef ParentName="DMS_DroidKind">
    <defName>DMS_Drone_Hound</defName>
    <label>hound</label>
    <labelPlural>hounds</labelPlural>
    <race>DMS_Drone_Hound</race>
    <combatPower>10</combatPower>
    <allowInMechClusters>false</allowInMechClusters>
    <forceNoDeathNotification>true</forceNoDeathNotification>
    <lifeStages>
      <li>
        <bodyGraphicData>
          <texPath>Things/Automatroid/hound</texPath>
          <shaderType>CutoutComplex</shaderType>
          <graphicClass>Graphic_Multi</graphicClass>
          <drawSize>1.1</drawSize>
          <shadowData>
            <volume>(0.2, 0.3, 0.2)</volume>
          </shadowData>
        </bodyGraphicData>
      </li>
      <li>
        <bodyGraphicData>
          <texPath>Things/Automatroid/OldTexture/hound</texPath>
          <shaderType>CutoutComplex</shaderType>
          <graphicClass>Graphic_Multi</graphicClass>
          <drawSize>1.1</drawSize>
          <shadowData>
            <volume>(0.2, 0.3, 0.2)</volume>
          </shadowData>
        </bodyGraphicData>
      </li>
    </lifeStages>
    <weaponTags>
      <li>Pistol</li>
    </weaponTags>
  </PawnKindDef>

  <ThingDef ParentName="DMS_BaseDroidRace">
    <defName>DMS_Drone_VerlingBrid</defName>
    <label>Verling bird</label>
    <description>A quad-drone built for reconnaissance. It is quite fragile in combat but moves extremely fast. It can be equipped with a small-caliber gun or grenade to provide combat capabilities.</description>
    <statBases>
      <MoveSpeed>8.2</MoveSpeed>
    </statBases>
    <race>
      <body>DMS_Chop</body>
      <baseBodySize>0.25</baseBodySize>
      <baseHealthScale>0.5</baseHealthScale>
      <mechWeightClass>Light</mechWeightClass>
      <thinkTreeConstant>DMS_DroneConstant</thinkTreeConstant>
    </race>
    <comps>
      <li Class="CompProperties_MechPowerCell">
        <totalPowerTicks>15000</totalPowerTicks>
      </li>
      <li MayRequire="oskarpotocki.vanillafactionsexpanded.core" Class="VEF.AnimalBehaviours.CompProperties_Floating">
        <canCrossWater>true</canCrossWater>
        <isFloater>true</isFloater>
      </li>
      <li Class="Fortified.CompProperties_FlyingFleckThrower">
        <burstOffsetRange>(1,1.5)</burstOffsetRange>
        <fleckOnSoil>DustPuff</fleckOnSoil>
        <fleckOnSnow>AirPuff</fleckOnSnow>
        <activeAnimation>DMS_Hover</activeAnimation>
        <sizeRange>(1,1.2)</sizeRange>
        <speedRange>(0.75,1)</speedRange>
        <throwRate>1</throwRate>
        <throwTick>5</throwTick>
      </li>
    </comps>
    <modExtensions>
      <li Class="Fortified.MechWeaponExtension">
        <EnableWeaponFilter>true</EnableWeaponFilter>
        <UsableWeaponTags>
          <li>VerlingBird_Weapon</li>
          <li>DMS_MechWeaponUltraLight</li>
          <li>PLA_RocketLauncherSingleUse</li>
          <li>CE_AI_Grenade</li>
          <li>DMS_Flameblaster</li>
        </UsableWeaponTags>
        <EnableTechLevelFilter>true</EnableTechLevelFilter>
        <UsableTechLevels>
          <li>Industrial</li>
        </UsableTechLevels>
        <BypassUsableWeapons>
          <li MayRequire="ceteam.combatextended">Gun_BinocularsRadio</li>
        </BypassUsableWeapons>
      </li>
    </modExtensions>
  </ThingDef>

  <PawnKindDef ParentName="DMS_DroidKind">
    <defName>DMS_Drone_VerlingBrid</defName>
    <label>Verling bird</label>
    <labelPlural>Verling boids</labelPlural>
    <race>DMS_Drone_VerlingBrid</race>
    <combatPower>5</combatPower>
    <allowInMechClusters>false</allowInMechClusters>
    <forceNoDeathNotification>true</forceNoDeathNotification>
    <lifeStages>
      <li>
        <bodyGraphicData>
          <texPath>Things/Automatroid/chad</texPath>
          <shaderType>CutoutComplex</shaderType>
          <graphicClass>Graphic_Multi</graphicClass>
          <drawSize>1.5</drawSize>
        </bodyGraphicData>
      </li>
      <li>
        <bodyGraphicData>
          <texPath>Things/Automatroid/OldTexture/chad</texPath>
          <shaderType>CutoutComplex</shaderType>
          <graphicClass>Graphic_Multi</graphicClass>
          <drawSize>1.5</drawSize>
        </bodyGraphicData>
      </li>
    </lifeStages>
    <weaponTags>
      <li>Pistol</li>
    </weaponTags>
  </PawnKindDef>
</Defs>