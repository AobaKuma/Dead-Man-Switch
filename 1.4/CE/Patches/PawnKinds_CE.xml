<?xml version="1.0" encoding="utf-8"?>
<Patch>

	<Operation Class="PatchOperationFindMod">
		<mods>
			<li>Combat Extended</li>
		</mods>

		<match Class="PatchOperationSequence">
			<operations>
				<li Class="PatchOperationAddModExtension">
					<xpath>Defs/PawnKindDef[defName="DMS_Mechanitor"]</xpath>
					<value>
						<li Class="CombatExtended.LoadoutPropertiesExtension">
							<primaryMagazineCount>
								<min>2</min>
								<max>4</max>
							</primaryMagazineCount>
							<sidearms>
								<li>
									<generateChance>0.85</generateChance>
						            <sidearmMoney>
							            <min>20</min>
							            <max>120</max>
						            </sidearmMoney>
						            <weaponTags>
							            <li>CE_Sidearm_Melee</li>
						            </weaponTags>
								</li>
							</sidearms>
						</li>
					</value>
				</li>
				<!-- DMS civilian and traders -->
				<li Class="PatchOperationAddModExtension">
					<xpath>Defs/PawnKindDef[@Name="DMS_CivilianBase"]</xpath>
					<value>
						<li Class="CombatExtended.LoadoutPropertiesExtension">
							<primaryMagazineCount>
								<min>2</min>
								<max>4</max>
							</primaryMagazineCount>
							<sidearms>
								<li>
									<generateChance>0.85</generateChance>
						            <sidearmMoney>
							            <min>20</min>
							            <max>120</max>
						            </sidearmMoney>
						            <weaponTags>
							            <li>CE_Sidearm_Melee</li>
						            </weaponTags>
								</li>
							</sidearms>
						</li>
					</value>
				</li>


				<!-- T2 patrol police  -->
				<li Class="PatchOperationAddModExtension">
					<xpath>Defs/PawnKindDef[defName="DMS_Police_Pistol"]</xpath>
					<value>
						<li Class="CombatExtended.LoadoutPropertiesExtension">
							<primaryMagazineCount>
								<min>3</min>
								<max>5</max>
							</primaryMagazineCount>
							<sidearms>
								<li>
									<generateChance>0.5</generateChance>
						            <sidearmMoney>
							            <min>20</min>
							            <max>120</max>
						            </sidearmMoney>
						            <weaponTags>
							            <li>CE_Sidearm_Melee</li>
						            </weaponTags>
								</li>
							</sidearms>
						</li>
					</value>
				</li>

				<!-- T2 riot police (melee) -->
				<li Class="PatchOperationAdd">
					<xpath>Defs/PawnKindDef[defName="DMS_Police_Melee"]/apparelRequired</xpath>
					<value>
						<li>CE_Apparel_BallisticShield</li>
					</value>
				</li>

				<!-- T2 squad service man -->
				<li Class="PatchOperationAddModExtension">
					<xpath>Defs/PawnKindDef[defName="DMS_Squad_ServiceMan"]</xpath>
					<value>
						<li Class="CombatExtended.LoadoutPropertiesExtension">
							<primaryMagazineCount>
								<min>6</min>
								<max>7</max>
							</primaryMagazineCount>
							<sidearms>
								<li>
									<sidearmMoney>
										<min>250</min>
										<max>500</max>
									</sidearmMoney>
									<weaponTags>
										<li>RangedLight</li>
										<li>CE_Sidearm_Melee</li>
									</weaponTags>
									<magazineCount>
										<min>0</min>
										<max>1</max>
									</magazineCount>
								</li>
							</sidearms>
						</li>
					</value>
				</li>	

				<!-- T2 squad Sniper -->
				<li Class="PatchOperationAddModExtension">
					<xpath>Defs/PawnKindDef[defName="DMS_Squad_Sniper"]</xpath>
					<value>
						<li Class="CombatExtended.LoadoutPropertiesExtension">
							<primaryMagazineCount>
								<min>10</min>
								<max>12</max>
							</primaryMagazineCount>
							<sidearms>
								<li>
									<sidearmMoney>
										<min>250</min>
										<max>500</max>
									</sidearmMoney>
									<weaponTags>
										<li>RangedLight</li>
										<li>CE_Sidearm_Melee</li>
									</weaponTags>
									<magazineCount>
										<min>0</min>
										<max>1</max>
									</magazineCount>
								</li>
							</sidearms>
						</li>
					</value>
				</li>	

				<!-- T2 riot police (ranged) -->
				<li Class="PatchOperationAddModExtension">
					<xpath>Defs/PawnKindDef[defName="DMS_Police_Ranged"]</xpath>
					<value>
						<li Class="CombatExtended.LoadoutPropertiesExtension">
							<primaryMagazineCount>
								<min>6</min>
								<max>8</max>
							</primaryMagazineCount>
							<sidearms>
								<li>
									<generateChance>0.5</generateChance>
						            <sidearmMoney>
							            <min>50</min>
							            <max>150</max>
						            </sidearmMoney>
						            <weaponTags>
										<li>Autopistol</li>
							            <li>CE_Sidearm_Melee</li>
						            </weaponTags>
									<magazineCount>
										<min>0</min>
										<max>1</max>
									</magazineCount>
								</li>
							</sidearms>
						</li>
					</value>
				</li>

				<!-- T3 Soldier -->
				<li Class="PatchOperationAddModExtension">
					<xpath>Defs/PawnKindDef[defName="DMS_Soldier"]</xpath>
					<value>
						<li Class="CombatExtended.LoadoutPropertiesExtension">
							<primaryMagazineCount>
								<min>8</min>
								<max>10</max>
							</primaryMagazineCount>
							<shieldMoney>
								<min>500</min>
								<max>900</max>
							</shieldMoney>
							<shieldTags>
								<li>OutlanderShield</li>
							</shieldTags>
							<shieldChance>0.9</shieldChance>
							<sidearms>
								<li>
						            <sidearmMoney>
							            <min>250</min>
							            <max>500</max>
						            </sidearmMoney>
						            <weaponTags>
										<li>RangedLight</li>
							            <li>CE_Sidearm_Melee</li>
						            </weaponTags>
									<magazineCount>
										<min>2</min>
										<max>3</max>
									</magazineCount>
								</li>
							</sidearms>
						</li>
					</value>
				</li>

			</operations>
		</match>

	</Operation>

</Patch>